{% extends "base.html" %}

{% block content %}
<h2>Scan Results</h2>

{% if results.network or results.web %}
    {% if results.network %}
        <h3>Network Scan Results</h3>
        {% for scan, data in results.network.items() %}
            <h4>{{ scan }}</h4>
            <p><strong>Description:</strong> {{ data.description }}</p>
            <pre>{{ data.output | safe }}</pre>
            {% if data.analysis %}
                <h5>Remediation Suggestions:</h5>
                <pre>{{ data.analysis }}</pre>
            {% endif %}
        {% endfor %}
    {% endif %}

    {% if results.web %}
        <h3>Web Scan Results</h3>
        {% for scan, data in results.web.items() %}
            <h4>{{ scan }}</h4>
            <p><strong>Description:</strong> {{ data.description }}</p>
            <pre>{{ data.output | safe }}</pre>
            {% if data.analysis %}
                <h5>Remediation Suggestions:</h5>
                <pre>{{ data.analysis }}</pre>
            {% endif %}
        {% endfor %}
    {% endif %}
{% else %}
    <p>No scan results available. Please run a scan first.</p>
{% endif %}

<a href="/">Back</a>
{% endblock %}

